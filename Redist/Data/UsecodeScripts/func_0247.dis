  .funcnumber 0247H ;* Bedroll
  .data
L0000: db '@There is no room for thy bedroll there.@'
L0029: db 00
  .code
  .argc 0001H
  .localc 0005H
  .externsize 0002H
  .extern 0828H
  .extern 08FFH
0000: 48   push eventid
0001: 1F 01 00   pushi 0001H   ; 1
0004: 22   cmpeq
0005: 3E   push itemref
0006: 38 6E 00 01  callis 006E, 1  ;* Get owner.
000A: 10   not
000B: 0E   and
000C: 05 C0 00   jne 00CF  ;* Jmp if owner != 0.
000F: 3E   push itemref
0010: 38 18 00 01  callis 0018, 1
0014: 12 00 00   pop [0000]  ;* Get location.
0017: 3E   push itemref
0018: 38 12 00 01  callis _GetItemFrame@1  ; 0012
001C: 1F 00 00   pushi 0000H   ; 0
001F: 22   cmpeq
0020: 05 AC 00   jne 00CF
0023: 3E   push itemref
0024: 38 25 00 01  callis 0025, 1  ;* Set it as last_created.
0028: 12 01 00   pop [0001]
002B: 21 01 00   push [0001]
002E: 05 9E 00   jne 00CF
0031: 1F 11 00   pushi 0011H   ; 17
0034: 1F F3 03   pushi 03F3H   ; 1011
0037: 21 00 00   push [0000]  ;* Location.
003A: 38 85 00 03  callis 0085, 3  ;* Not blocked for horiz. bed?
003E: 12 02 00   pop [0002]
0041: 21 00 00   push [0000]
0044: 38 26 00 01  callis 0026, 1
0048: 12 01 00   pop [0001]
004B: 21 02 00   push [0002]
004E: 21 01 00   push [0001]
0051: 0E   and
0052: 05 64 00   jne 00B9  ;* Jmp if no room.
0055: 39 7E 00 00  calli 007E, 0
0059: 1F 01 00   pushi 0001H   ; 1
005C: 1F 01 00   pushi 0001H   ; 1
005F: 1F 01 00   pushi 0001H   ; 1
0062: 1F 00 00   pushi 0000H   ; 0
0065: 1F 00 00   pushi 0000H   ; 0
0068: 1F 00 00   pushi 0000H   ; 0
006B: 1F FF FF   pushi FFFFH   ; -1
006E: 1F FF FF   pushi FFFFH   ; -1
0071: 1F FF FF   pushi FFFFH   ; -1
0074: 1E 09 00   arrc 0009H   ; 9
0077: 12 03 00   pop [0003]
007A: 1F FF FF   pushi FFFFH   ; -1
007D: 1F 00 00   pushi 0000H   ; 0
0080: 1F 01 00   pushi 0001H   ; 1
0083: 1F FF FF   pushi FFFFH   ; -1
0086: 1F 00 00   pushi 0000H   ; 0
0089: 1F 01 00   pushi 0001H   ; 1
008C: 1F FF FF   pushi FFFFH   ; -1
008F: 1F 00 00   pushi 0000H   ; 0
0092: 1F 01 00   pushi 0001H   ; 1
0095: 1E 09 00   arrc 0009H   ; 9
0098: 12 04 00   pop [0004]
009B: 1F 9C FE   pushi FE9CH   ; -356
009E: 39 5C 00 01  calli 005C, 1  ;* Halt scheduled?  no...
00A2: 1F 07 00   pushi 0007H   ; 7   eventid
00A5: 3E   push itemref
00A6: 1F 47 02   pushi 0247H   ; 583  usecode
00A9: 1F FF FF   pushi FFFFH   ; -1
00AC: 21 04 00   push [0004]
00AF: 21 03 00   push [0003]
00B2: 3E   push itemref
00B3: 24 00 00   call [0000]   ; 0828H
00B6: 06 16 00   jmp 00CF
00B9: 1F 02 00   pushi 0002H   ; 2
00BC: 26 00 00   aidx [0000]
00BF: 1F 05 00   pushi 0005H   ; 5
00C2: 0A   sub
00C3: 1F 02 00   pushi 0002H   ; 2
00C6: 46 00 00   db 46 ???
   dw 0000H   ; 0
00C9: 1D 00 00   pushs L0000   ; @There is no room...
00CC: 24 01 00   call [0001]   ; 08FFH
00CF: 48   push eventid
00D0: 1F 07 00   pushi 0007H   ; 7
00D3: 22   cmpeq
00D4: 05 2A 00   jne 0101
00D7: 44 61   pushw 4461H   ; 17505
00D9: 44 6C   pushw 446CH   ; 17516
00DB: 44 30   pushw 4430H   ; 17456
00DD: 44 59   pushw 1E59H   ; 7769
00DF: 1E 04 00   arrc 0004H   ; 4
00E2: 1F 9C FE   pushi FE9CH   ; -356
00E5: 38 01 00 02  callis 0001, 2
00E9: 12 01 00   pop [0001]
00EC: 1F 47 02   pushi 0247H   ; 583
00EF: 44 55   pushw 1F55H   ; 8021
00F1: 1F 02 00   pushi 0002H   ; 2
00F4: 44 27   pushw 1E27H   ; 7719
00F6: 1E 04 00   arrc 0004H   ; 4
00F9: 3E   push itemref
00FA: 38 01 00 02  callis 0001, 2
00FE: 12 01 00   pop [0001]
0101: 48   push eventid
0102: 1F 02 00   pushi 0002H   ; 2
0105: 22   cmpeq
0106: 05 10 00   jne 0119
0109: 1F F3 03   pushi 03F3H   ; 1011
010C: 3E   push itemref
010D: 39 0D 00 02  calli _SetItemType@2  ; 000D
0111: 1F 11 00   pushi 0011H   ; 17
0114: 3E   push itemref  ;* Turn into bed.
0115: 39 13 00 02  calli _SetItemFrame@2  ; 0013
0119: 25   ret
