  .funcnumber 0828H
  .data  ;* Use bucket on:
  .code
  .argc 0007H ;* P0=new eventid, P1=bucket, P2=shape
    ; P3=-n, P4=array of #'s, P5=array,
    ; P6=selected item
  .localc 0008H
  .externsize 0000H
0000: 21 06 00   push [0006]
0003: 38 6E 00 01  callis 006E, 1  ;* Get container of sel. item.
0007: 05 08 00   jne 0012  ;* Jump if none.
000A: 1F 00 00   pushi 0000H   ; 0
000D: 39 6A 00 01  calli 006A, 1
0011: 3F   abrt
0012: 1F 9C FE   pushi FE9CH   ; -356
0015: 39 5C 00 01  calli 005C, 1    ;* ??
0019: 21 06 00   push [0006]
001C: 38 18 00 01  callis 0018, 1
0020: 12 07 00   pop [0007]  ;* Loc. of sel. item.
0023: 21 05 00   push [0005]
0026: 1F 00 00   pushi 0000H   ; 0
0029: 17   cmpl   ;* P5 < 0 ?
002A: 21 05 00   push [0005]
002D: 38 5E 00 01  callis _ArraySize@1  ; 005E
0031: 1F 01 00   pushi 0001H   ; 1
0034: 22   cmpeq   ;* && #P5==1.
0035: 0E   and
0036: 05 A9 00   jne 00E2  ;* Jmp if not.
0039: 21 03 00   push [0003]
003C: 12 08 00   pop [0008]
003F: 21 08 00   push [0008]
0042: 1F 03 00   pushi 0003H   ; 3
0045: 26 07 00   aidx [0007]  ;* Get lift.
0048: 19   cmple   ;* 3 <= lift?
0049: 05 93 00   jne 00DF  ;* Jmp if not.
004C: 1F 03 00   pushi 0003H   ; 3
004F: 26 07 00   aidx [0007]
0052: 21 08 00   push [0008]
0055: 09   add
0056: 1F 03 00   pushi 0003H   ; 3
0059: 46 09 00   db 46 ???
   dw 0009H   ; 9
005C: 1F FF FF   pushi FFFFH   ; -1
005F: 21 05 00   push [0005]
0062: 0C   mul
0063: 12 0A 00   pop [000A]
0066: 21 0A 00   push [000A]
0069: 21 05 00   push [0005]
006C: 18   cmpge
006D: 05 62 00   jne 00D2
0070: 1F 01 00   pushi 0001H   ; 1
0073: 26 07 00   aidx [0007]
0076: 21 0A 00   push [000A]
0079: 09   add
007A: 1F 01 00   pushi 0001H   ; 1
007D: 46 09 00   db 46 ???
   dw 0009H   ; 9
0080: 1F FF FF   pushi FFFFH   ; -1
0083: 21 04 00   push [0004]
0086: 0C   mul
0087: 12 0B 00   pop [000B]
008A: 21 0B 00   push [000B]
008D: 21 04 00   push [0004]
0090: 18   cmpge
0091: 05 31 00   jne 00C5
0094: 1F 02 00   pushi 0002H   ; 2
0097: 26 07 00   aidx [0007]
009A: 21 0B 00   push [000B]
009D: 09   add
009E: 1F 02 00   pushi 0002H   ; 2
00A1: 46 09 00   db 46 ???
   dw 0009H   ; 9
00A4: 21 00 00   push [0000]
00A7: 21 01 00   push [0001]
00AA: 21 02 00   push [0002]
00AD: 21 09 00   push [0009]
00B0: 38 7D 00 04  callis 007D, 4
00B4: 05 01 00   jne 00B8
00B7: 2C   db 2c ???
00B8: 21 0B 00   push [000B]
00BB: 1F 01 00   pushi 0001H   ; 1
00BE: 0A   sub
00BF: 12 0B 00   pop [000B]
00C2: 06 C5 FF   jmp 008A
00C5: 21 0A 00   push [000A]
00C8: 1F 01 00   pushi 0001H   ; 1
00CB: 0A   sub
00CC: 12 0A 00   pop [000A]
00CF: 06 94 FF   jmp 0066
00D2: 21 08 00   push [0008]
00D5: 1F 01 00   pushi 0001H   ; 1
00D8: 09   add
00D9: 12 08 00   pop [0008]
00DC: 06 60 FF   jmp 003F
00DF: 06 E4 00   jmp 01C6
00E2: 1F 00 00   pushi 0000H   ; 0
00E5: 12 0C 00   pop [000C]
00E8: 2E   sloop   ;* Loop through array.
00E9: 02 0D 00 0E 00 0A 00 05 00 CA 00  db 2 ???
00EA:   db d
00EB:   db 0
00EC:   db e
00ED:   db 0
00EE:   db a
00EF:   db 0
00F0:   db 5
00F1:   db 0
00F2:   db ca
00F3:   db 0
00F4: 21 0C 00   push [000C]  ;* Counter.
00F7: 1F 01 00   pushi 0001H   ; 1
00FA: 09   add
00FB: 12 0C 00   pop [000C]
00FE: 21 0C 00   push [000C]
0101: 26 04 00   aidx [0004]
0104: 12 0B 00   pop [000B]  ;* P4[i].
0107: 21 0C 00   push [000C]
010A: 26 03 00   aidx [0003]
010D: 12 08 00   pop [0008]  ;* P3[i].
0110: 1F 01 00   pushi 0001H   ; 1
0113: 26 07 00   aidx [0007]  ;* loc.x
0116: 21 0A 00   push [000A]  ;* loc.x + P5[i]
0119: 09   add
011A: 1F 01 00   pushi 0001H   ; 1
011D: 46 09 00   db 46 ???
   dw 0009H   ; 9  newloc.x
0120: 1F 02 00   pushi 0002H   ; 2
0123: 26 07 00   aidx [0007]
0126: 21 0B 00   push [000B]
0129: 09   add
012A: 1F 02 00   pushi 0002H   ; 2 newloc.y
012D: 46 09 00   db 46 ???
   dw 0009H   ; 9
0130: 21 03 00   push [0003]  ;* # (-3 1st time).
0133: 1F FF FF   pushi FFFFH   ; -1
0136: 17   cmpl   ;* -3 < -1 ?
0137: 05 44 00   jne 017E
013A: 1F 00 00   pushi 0000H   ; 0
013D: 12 08 00   pop [0008]  ; 0
0140: 21 08 00   push [0008]
0143: 21 03 00   push [0003]  
0146: 18   cmpge   ;* L8 >= P3?
0147: 05 31 00   jne 017B
014A: 1F 03 00   pushi 0003H   ; 3
014D: 26 07 00   aidx [0007]  ;* loc.z
0150: 21 08 00   push [0008]
0153: 09   add
0154: 1F 03 00   pushi 0003H   ; 3
0157: 46 09 00   db 46 ???
   dw 0009H   ; 9 newloc.z
015A: 21 00 00   push [0000]  ;* Eventid
015D: 21 01 00   push [0001]  ;* Bucket ref.
0160: 21 02 00   push [0002]  ;* Usecode # (bucket)
0163: 21 09 00   push [0009]  ;* New location?
0166: 38 7D 00 04  callis 007D, 4
016A: 05 01 00   jne 016E
016D: 2C   db 2c ???
016E: 21 08 00   push [0008]
0171: 1F 01 00   pushi 0001H   ; 1
0174: 0A   sub
0175: 12 08 00   pop [0008]
0178: 06 C5 FF   jmp 0140
017B: 06 3D 00   jmp 01BB
017E: 21 03 00   push [0003]
0181: 1F FF FF   pushi FFFFH   ; -1
0184: 22   cmpeq
0185: 05 0F 00   jne 0197
0188: 1F 03 00   pushi 0003H   ; 3
018B: 26 07 00   aidx [0007]
018E: 1F 03 00   pushi 0003H   ; 3
0191: 46 09 00   db 46 ???
   dw 0009H   ; 9 newloc.z
0194: 06 10 00   jmp 01A7
0197: 1F 03 00   pushi 0003H   ; 3
019A: 26 07 00   aidx [0007]
019D: 21 08 00   push [0008]
01A0: 09   add
01A1: 1F 03 00   pushi 0003H   ; 3
01A4: 46 09 00   db 46 ???
   dw 0009H   ; 9
01A7: 21 00 00   push [0000]
01AA: 21 01 00   push [0001]
01AD: 21 02 00   push [0002]
01B0: 21 09 00   push [0009]
01B3: 38 7D 00 04  callis 007D, 4
01B7: 05 01 00   jne 01BB
01BA: 2C   db 2c ???
01BB: 06 2B FF   jmp 00E9
01BE: 1F 00 00   pushi 0000H   ; 0
01C1: 39 6A 00 01  calli 006A, 1
01C5: 3F   abrt
01C6: 25   ret
